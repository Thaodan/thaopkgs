.\" Automatically generated by Pod::Man version 1.15
.\" Sun Sep  8 21:56:03 2002
.\"
.\" Standard preamble:
.\" ======================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Ip \" List item
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R

.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used
.\" to do unbreakable dashes and therefore won't be available.  \*(C` and
.\" \*(C' expand to `' in nroff, nothing in troff, for use with C<>
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.\"    ds C` ""
.\"    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr
.\" for titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and
.\" index entries marked with X<> in POD.  Of course, you'll have to process
.\" the output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it
.\" makes way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.bd B 3
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ======================================================================
.\"
.IX Title "nadvsh 6"
.TH nadvsh 6 " " "2002/09/08" " "
.UC
.SH "NAME"
\&\f(CW\*(C`nadvsh\*(C'\fR \- New adventure shell
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\f(CW\*(C`. nadvsh [ \-noplay ] [ \-safe | \-nosafe ]\*(C'\fR
.PP
\&\f(CW\*(C`         [ \-strict | \-semistrict | \-nostrict ]\*(C'\fR
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\f(CW\*(C`nadvsh\*(C'\fR is the new adventure shell. It is a shell extension that makes
your shell environment act like a text adventure game. It features objects
which you may take with you in your backpack, and which you may use;
interaction with other users; and non-player characters (NPC`s), which
may either be helpful or a nuisance. Theme files may be loaded in order
to set up a specific environment with matching objects and NPC`s.
.SH "OPTIONS"
.IX Header "OPTIONS"
The \f(CW\*(C`\-strict\*(C'\fR, \f(CW\*(C`\-semistrict\*(C'\fR and \f(CW\*(C`\-nosafe\*(C'\fR options make the shell
behave as if a corresponding \fBplay [semi]strict\fR or \fBplay nosafe\fR
command had been given. \fBnostrict\fR and \fBsafe\fR are the defaults (see
below under \fB\s-1COMMANDS\s0\fR).
.PP
The \f(CW\*(C`\-noplay\*(C'\fR option causes the shell to read all the required
definitions, but to not engage in playing yet.
.SH "COMMANDS"
.IX Header "COMMANDS"
.Sh "Movement and location-related commands"
.IX Subsection "Movement and location-related commands"
In the following commands, \fIlocation\fR denotes a valid directory.
.PP
The commands \fBnorth\fR, \fBdown\fR etc. are intended for dedicated adventure
directory hierarchies.
.Ip "\fBcd\fR \fIlocation\fR" 4
.IX Item "cd location"
\&\fBcd\fR is aliased to a function when the user has engaged in the adventure.
.Ip "\fBclose\fR \fIlocation\fR" 4
.IX Item "close location"
See \fBopen\fR.
.Ip "\fBdesc[ribe]\fR" 4
.IX Item "desc[ribe]"
Redescribes the current location.
.Ip "\fBdown\fR, \fBd\fR" 4
.IX Item "down, d"
Go down, if there is a subdirectory with that name.
.Ip "\fBeast\fR, \fBe\fR" 4
.IX Item "east, e"
Go east, if there is a subdirectory with that name.
.Ip "\fBenter\fR \fIlocation\fR" 4
.IX Item "enter location"
Identical to \fBcd\fR.
.Ip "\fBgo\fR \fIlocation\fR" 4
.IX Item "go location"
Identical to \fBcd\fR; additionally, \fBgo back\fR is identical to \fBcd ..\fR
.Ip "\fBleave\fR" 4
.IX Item "leave"
Identical to \fBcd ..\fR
.Ip "\fBlock\fR \fIlocation\fR" 4
.IX Item "lock location"
See \fBopen\fR.
.Ip "\fBlo[ok] [ hard | [in]to\fR \fIlocation\fR \fB]\fR" 4
.IX Item "lo[ok] [ hard | [in]to location ]"
Look around in the current location, or in another location.
.Ip "\fBopen\fR \fIlocation\fR" 4
.IX Item "open location"
\&\fBopen, close, lock\fR and \fBunlock\fR set permissions to restrictive or
permissive. In filesystem terms, this means:
.Sp
.Vb 4
\&    open:       go+rwX
\&    unlock:     go+rX
\&    close:      go-w
\&    lock:       go-rwx
.Ve
where X is a conditional x.  Like in real life, lock implies close, open
implies unlock, and a location may be unlocked and closed at the same time.
.Ip "\fBnorth\fR, \fBn\fR" 4
.IX Item "north, n"
Go north, if there is a subdirectory with that name.
.Ip "\fBnortheast\fR, \fBne\fR" 4
.IX Item "northeast, ne"
Go northeast, if there is a subdirectory with that name.
.Ip "\fBnorthwest\fR, \fBnw\fR" 4
.IX Item "northwest, nw"
Go northwest, if there is a subdirectory with that name.
.Ip "\fBsouth\fR, \fBs\fR" 4
.IX Item "south, s"
Go south, if there is a subdirectory with that name.
.Ip "\fBsoutheast\fR, \fBse\fR" 4
.IX Item "southeast, se"
Go southeast, if there is a subdirectory with that name.
.Ip "\fBsouthwest\fR, \fBsw\fR" 4
.IX Item "southwest, sw"
Go southwest, if there is a subdirectory with that name.
.Sp
Identical to \fBsouthwest\fR.
.Ip "\fBunlock\fR \fIlocation\fR" 4
.IX Item "unlock location"
See \fBopen\fR.
.Ip "\fBup\fR, \fBu\fR" 4
.IX Item "up, u"
Go up, if there is a subdirectory with that name.
.Ip "\fBwest\fR, \fBw\fR" 4
.IX Item "west, w"
Go west, if there is a subdirectory with that name.
.Sh "Object-related commands"
.IX Subsection "Object-related commands"
Note that if an object name is required, and the object name contains
spaces, the spaces (or the entire object name) should be quoted.
.Ip "\fBbuy\fR \fIobject_class\fR \fB[ as\fR \fIobject_name\fR \fB ] [ for\fR \fIamount\fR \fB]\fR" 4
.IX Item "buy object_class [ as object_name  ] [ for amount ]"
Buy an object (probably equipment) from the specified object class. You may
buy an object and specify a distinct name for it at the same time using
\&\fBas\fR. Your bid (specified using \fBfor\fR) determines which quality you will get.
.Sp
Allowed object classes are: \fBweapon\fR, \fB'missile weapon'\fR, \fBmissile\fR,
\&\fBarmor\fR, \fBhelmet\fR, \fBshield\fR, \fBclothing\fR, \fBbackpack\fR, \fBfood\fR,
\&\fBdrink\fR, or \fBobject\fR for an ordinary item (for which the name should be
specified). For user-friendliness, the object class name \fBsword\fR is also
supported, as well as the use of a miscellaneous object name instead of
\&\fBobject\fR. The use of \fBsword\fR is discouraged.
.Sp
Examples using object class:
.Sp
.Vb 6
\&    buy 'missile weapon'
\&    buy armor for 60
\&    buy food as 'emmenthaler cheese'
\&    buy drink as 'some milk' for 2
\&    buy weapon as 'orc slayer' for 40
\&    buy object as 'handpainted teapot'
.Ve
Examples using object names:
.Sp
.Vb 2
\&    buy sword as 'dragon killer' for 30
\&    buy 'handpainted teapot'
.Ve
.Ip "\fBdestroy\fR \fIobject\fR" 4
.IX Item "destroy object"
Destroy an object that you are carrying.
.Ip "\fBdon\fR \fIobject\fR" 4
.IX Item "don object"
Identical to \fBwear\fR.
.Ip "\fBdrink\fR \fIobject\fR" 4
.IX Item "drink object"
Drink something. This will usually strengthen you.
.Ip "\fBdrop\fR \fIobject\fR \fB[ as\fR \fIobject_name\fR \fB] |\fR \fIamount\fR \fIcurrency\fR" 4
.IX Item "drop object [ as object_name ] | amount currency"
Take an object or money out of your backpack and drop it. An object may be
given a new name at the same time. File permissions must allow the action.
Money that is dropped changes into a \fImoney object\fR. Picking it
up will retransform it into real money (should this fail, then use the
\&\fBsell\fR command to cash in the money object).
.Sp
Note the difference between:
.Sp
.Vb 1
\&    drop '10 florins'
.Ve
which will drop an object (probably a money object), and:
.Sp
.Vb 1
\&    drop 10 florins
.Ve
which will drop some of your money in the form of a money object.
.Ip "\fBeat\fR \fIobject\fR" 4
.IX Item "eat object"
Eat something. This will usually strengthen you.
.Ip "\fBexam[ine]\fR \fIobject\fR" 4
.IX Item "exam[ine] object"
Displays the specified file. Files representing objects should contain their
description. See \fB\s-1FILES\s0\fR below.
.Ip "\fBinv[entory]\fR" 4
.IX Item "inv[entory]"
Displays the contents of your backpack, the items you are wearing and wielding,
and your current amount of money.
.Ip "\fBget\fR \fIobject\fR \fB[ as\fR \fIobject_name\fR \fB]\fR" 4
.IX Item "get object [ as object_name ]"
Identical to \fBtake\fR.
.Ip "\fBlo[ok] at\fR \fIobject\fR" 4
.IX Item "lo[ok] at object"
Identical to \fBexamine\fR.
.Ip "\fBput [ away ]\fR \fIobject\fR" 4
.IX Item "put [ away ] object"
Identical to \fBstow away\fR.
.Ip "\fBput on\fR \fIobject\fR" 4
.IX Item "put on object"
Identical to \fBwear\fR.
.Ip "\fBquaff\fR \fIobject\fR" 4
.IX Item "quaff object"
Drink a potion. Effects may be beneficial or harmful. (Not implemented)
.Ip "\fBrename\fR \fIobject\fR \fBto\fR \fIobject\fR" 4
.IX Item "rename object to object"
Give an object a new name. You must be carrying it.
.Ip "\fBsell\fR \fIobject\fR" 4
.IX Item "sell object"
Sell an object of your inventory (probably something valuable). You may
accept or reject the amount offered.
.Sp
Also, if you somehow get stuck with a money object in your inventory,
you may cash it in with the \fBsell\fR command.
.Ip "\fBstow [ away ]\fR \fIobject\fR" 4
.IX Item "stow [ away ] object"
Put an object which you are using in your backpack. Opposite of \fBwear\fR
and \fBwield\fR.
.Ip "\fBtake\fR \fIobject\fR \fB[ as\fR \fIobject_name\fR \fB]\fR" 4
.IX Item "take object [ as object_name ]"
Pick up a portable object and put it in your backpack. The object may be
renamed at the same time, e.g. if you are already carrying another object
of the same type. File permissions must allow the action. If the object
is a valid \fImoney object\fR, it will not be picked up; instead, the amount
will be added to your money.
.Ip "\fBtake off\fR \fIobject\fR" 4
.IX Item "take off object"
Identical to \fBstow away\fR.
.Ip "\fBunwear\fR \fIobject\fR" 4
.IX Item "unwear object"
Take off clothing. Identical to \fBstow away\fR.
.Ip "\fBunwield\fR \fIobject\fR" 4
.IX Item "unwield object"
Identical to \fBstow away\fR.
.Ip "\fBuse\fR \fIobject\fR" 4
.IX Item "use object"
Fire a wand or read a scroll. (Not implemented)
.Ip "\fBwear\fR \fIobject\fR" 4
.IX Item "wear object"
Wear clothing, armor or ring. Opposite of \fBstow away\fR. You may only
combine items of clothing if they belong to different clothing types
(see \fBObject classes\fR below). You may wear at most two rings at any time
(one on every hand).
.Ip "\fBwield\fR \fIobject\fR" 4
.IX Item "wield object"
Select your preferred weapon, or use a lightsource. Opposite of \fBstow away\fR.
You may wield at most two weapons at any time (one in each hand).
.Sh "Person-related commands"
.IX Subsection "Person-related commands"
.Ip "\fBemote\fR \fIsentence\fR" 4
.IX Item "emote sentence"
Describe an action you are performing to the players in the same location
(i.e. users that share the same current working directory). The sentence
should be formulated without a subject, and in the third person.
.Sp
Example:
.Sp
The command:
.Sp
.Vb 1
\&    emote smiles.
.Ve
produces on the terminals of the users who are present in the same
location:
.Sp
.Vb 1
\&    <Your username> smiles.
.Ve
.Ip "\fBexam[ine]\fR \fIperson\fR" 4
.IX Item "exam[ine] person"
Examine a person (user or \s-1NPC\s0).
.Ip "\fBfight\fR \fI\s-1NPC\s0\fR \fB[ with\fR \fIobject\fR \fB]\fR" 4
.IX Item "fight NPC [ with object ]"
Identical to \fBkill\fR.
.Ip "\fBgive\fR \fIperson\fR \fIobject\fR" 4
.IX Item "give person object"
.PD 0
.Ip "\fBgive\fR \fIobject\fR \fBto\fR \fIperson\fR" 4
.IX Item "give object to person"
.PD
Put an item in another person`s backpack, if allowed.
.Ip "\fBinv[entory]\fR \fIperson\fR" 4
.IX Item "inv[entory] person"
Displays the contents of \fIperson\fR`s backpack. If the person is a user,
also displays the items the user is wearing and wielding.
.Ip "\fBkill\fR \fI\s-1NPC\s0\fR \fB[ with\fR \fIobject\fR \fB] |\fR \fIpid\fR" 4
.IX Item "kill NPC [ with object ] | pid"
Fight an \s-1NPC\s0, or kill a process. You may specify any weapon in your
possession, even if you are not wielding it. By default, you will attack
with the best weapon you are wielding. Killing other users has not
(yet?) been implemented.
.Ip "\fBlo[ok] at\fR \fIperson\fR" 4
.IX Item "lo[ok] at person"
Identical to \fBexamine\fR.
.Ip "\fBsay to\fR \fIperson\fR \fIsentence\fR" 4
.IX Item "say to person sentence"
.PD 0
.Ip "\fBsay\fR \fI'sentence'\fR \fBto\fR \fIperson\fR" 4
.IX Item "say 'sentence' to person"
.PD
Identical to \fBtell\fR.
.Ip "\fBshout\fR \fI'sentence'\fR" 4
.IX Item "shout 'sentence'"
Shout (using \fIwall\fR\|(1)) a message to all users currently logged in.
.Ip "\fBsteal\fR \fIobject\fR \fBfrom\fR \fIperson\fR" 4
.IX Item "steal object from person"
.PD 0
.Ip "\fBsteal\fR \fBfrom\fR \fIperson\fR \fIobject\fR" 4
.IX Item "steal from person object"
.PD
Try to take an item from another person`s backpack, if allowed.
.Ip "\fBtalk [to]\fR \fIperson\fR \fB[\fR \fIttyname\fR \fB]\fR" 4
.IX Item "talk [to] person [ ttyname ]"
Simple wrapper for \fItalk\fR\|(1).
.Ip "\fBtell\fR \fI'sentence'\fR \fBto\fR \fIperson\fR" 4
.IX Item "tell 'sentence' to person"
.PD 0
.Ip "\fBtell to\fR \fIperson\fR \fI'sentence'\fR" 4
.IX Item "tell to person 'sentence'"
.PD
\&\fIwrite\fR\|(1) a message to another user.
.Ip "\fBwhere [\fR \fIperson\fR \fB]\fR" 4
.IX Item "where [ person ]"
Tells the whereabouts of the non-player characters.
.Sh "Miscellaneous commands"
.IX Subsection "Miscellaneous commands"
.Ip "\fBcal\fR" 4
.IX Item "cal"
If invoked with no arguments, displays J.R.R. Tolkien`s Shire calendar.
See also \fBdate\fR.
.Ip "\fBcolors [ nocolor | . |\fR \fIcolorname\fR \fB|\fR \fIescape_codes\fR \fB]\fR \fB[ nocolor | . |\fR \fIcolorname\fR \fB|\fR \fIescape_codes\fR \fB]\fR" 4
.IX Item "colors [ nocolor | . | colorname | escape_codes ] [ nocolor | . | colorname | escape_codes ]"
Select colors to be used in the prompt string (\fB\s-1PS1\s0\fR) and in location
descriptions. You may specify \fB.\fR which leaves the color unchanged,
\&\fBnocolor\fR to suppress the use of color, a \fIcolorname\fR from the set
\&\fBblack, blue, red, magenta, green, cyan, yellow\fR or \fBwhite\fR, or an
escape sequence, e.g.:
.Sp
.Vb 1
\&        colors . `tput smul`
.Ve
Note that in the Korn shell, escape codes in the prompt string would mess
up the command line being edited; therefore, prompt coloring is never used
in ksh.
.Ip "\fBcurrency [\fR \fIcurrency_unit_plur\fR \fB[\fR \fIcurrency_unit_sing\fR \fB] ]\fR" 4
.IX Item "currency [ currency_unit_plur [ currency_unit_sing ] ]"
.PD 0
.Ip "\fBcurrency [\fR \fIcurrency_unit_plur\fR\fB/\fR\fIcurrency_unit_sing\fR \fB]\fR" 4
.IX Item "currency [ currency_unit_plur/currency_unit_sing ]"
.PD
If the currency of the land has changed, you may specify the name of the
new currency, e.g. 'gold pieces', 'cubits' or even 'patiwani shells'.
.Sp
If the singular form of the currency is not identical to the plural form
with the final 's' removed, the singular form may be specified as an
optional second argument. Example: \fBcurrency markoi marko\fR
.Sp
It is also allowed to specify the plural and singular forms in one
argument, separated by a slash. Example: \fBcurrency markoi/marko\fR
.Sp
Without arguments, the command will print the current currency unit. See
also \fB\s-1ENVIRONMENT\s0\fR below.
.Ip "\fBdate\fR" 4
.IX Item "date"
\&\fBdate\fR will print the Shire date, if \fIperl\fR\|(1) and Date::Tolkien::Shire have
been installed (available on \s-1CPAN\s0). See also \fBcal\fR.
.Ip "\fBdebug\fR \fIcommand\fR \fB[\fR \fIargs ...\fR \fB]\fR" 4
.IX Item "debug command [ args ... ]"
Run \fIcommand\fR in `set \-x` mode.  Primarily used for debugging, as you
might have guessed.
.Ip "\fBhelp\fR" 4
.IX Item "help"
Provides concise help on valid commands.
.Ip "\fBnocolors\fR" 4
.IX Item "nocolors"
Turns all color use off.
.Ip "\fBnoplay\fR" 4
.IX Item "noplay"
Disengage from playing.
.Ip "\fBplay [ [semi|no]strict ] [ [no]safe ]\fR" 4
.IX Item "play [ [semi|no]strict ] [ [no]safe ]"
Engage in playing. Variables are not reinitialized.
.Sp
The \fBsemistrict\fR option will disallow any \fBcd\fR to a directory with a
slash \fB/\fR in the name. The \fBstrict\fR option will additionally disallow
any \fBcd\fR to the parent directory. In this way, a pre-setup directory
tree can be turned into a closed world. Symbolic links to directories
may be used to create exits from locations with no subdirectories.
Additionally, \fBstrict\fR will prevent the current working directory from
being shown in the prompt string (\fB\s-1PS1\s0\fR), when there is a description
present. \fBnostrict\fR will impose none of these restrictions.
.Sp
The \fBnosafe\fR option will allow evaluation of commands specified in a
local \fI.nadvsh\fR file (see below under \fB\s-1FILES\s0\fR). This could be a
security problem, therefore, the default is \fBsafe\fR.
.Ip "\fBquit\fR" 4
.IX Item "quit"
Prints your score, then exits the adventure, cleaning up all variables,
functions and aliases. Your Unix shell will not exit.
.Ip "\fBreplay [ [semi|no]strict ] [ [no]safe ]\fR" 4
.IX Item "replay [ [semi|no]strict ] [ [no]safe ]"
Restart playing (reinitialize variables). \fBreplay\fR will require \f(CW\*(C`nadvsh\*(C'\fR
to be in the user`s \fB\s-1PATH\s0\fR. See also \fBplay\fR for the use of the \fBstrict\fR
options.
.Ip "\fBscore\fR" 4
.IX Item "score"
Displays the user`s score, strength and money. Experience points are received
for visiting locations, fighting monsters and collecting (valuable) objects.
.Ip "\fBtheme [ default | new\fR \fIfile\fR \fB| [add]\fR \fIfile\fR \fB| write\fR \fIfile\fR \fB]\fR" 4
.IX Item "theme [ default | new file | [add] file | write file ]"
Read in the theme file specified. \fBdefault\fR is used to specify the
built-in theme. The \fBnew\fR option may be used to discard all existing
location descriptions. With the \fBadd\fR option (default) the new
descriptions will be added to those already in memory. The \fBwrite\fR option
will write out a new theme file (not implemented).
.Sp
When \f(CW\*(C`nadvsh\*(C'\fR starts up, a default (builtin) theme is loaded. This
theme may be overruled by a theme file indicated by the environment
variable \fB\s-1NADVSH_THEME\s0\fR.
.Ip "\fBsleep\fR" 4
.IX Item "sleep"
Sleep in order to regain strength. NPC`s may move while you are sleeping.
.Ip "\fBwait [\fR \fIjobid\fR \fB]\fR" 4
.IX Item "wait [ jobid ]"
Allows other users and non-player characters to make a move.  If a jobid
is specified, then it also \fIwait\fR\|(2)s for the child process to end.
.SH "INDEPENDENT ACTION"
.IX Header "INDEPENDENT ACTION"
Non-player characters may act in ways that are not dependent on your actions.
They will, however, \fInot\fR drop objects when you are not around, to prevent
filesystem pollution; and they will \fInot\fR take objects from directories,
to prevent non-object files being picked up by mistake.
.SH "ENVIRONMENT"
.IX Header "ENVIRONMENT"
.Ip "\fB\s-1PAGER\s0\fR" 4
.IX Item "PAGER"
Identifies the pager with which to view text files. Defaults to \fIless\fR\|(1)
for Linux systems or \fImore\fR\|(1) for Unix systems.
.Ip "\fB\s-1NADVSH_CURRENCY\s0\fR" 4
.IX Item "NADVSH_CURRENCY"
The name of your favorite currency, in plural, optionally followed by
a slash and the singular form. See also the \fBcurrency\fR command.
.Ip "\fB\s-1NADVSH_DESCCOLOR\s0\fR" 4
.IX Item "NADVSH_DESCCOLOR"
Specifies whether color should be used for the location descriptions,
and which one. Normally \f(CW\*(C`nadvsh\*(C'\fR tries to figure out if color is
supported. You may override this check and force or suppress the use
of color.
.Sp
Valid values are: \fBnocolor\fR to suppress color, or a \fIcolorname\fR or
escape sequence as specified under the \fBcolors\fR command (see above).
.Ip "\fB\s-1NADVSH_PS1COLOR\s0\fR" 4
.IX Item "NADVSH_PS1COLOR"
As \fB\s-1NADVSH_DESCCOLOR\s0\fR, but used for color in the prompt string (\fB\s-1PS1\s0\fR).
.Ip "\fB\s-1NADVSH_THEME\s0\fR" 4
.IX Item "NADVSH_THEME"
Specifies which theme file should be loaded at startup instead of the
default (builtin) theme.
.SH "FILES"
.IX Header "FILES"
.Sh "Backpack files"
.IX Subsection "Backpack files"
The directory \fI$HOME/.nadvbackpack/\fR is the implementation of your
backpack.  You may choose to set the mode to very permissive, in order to
allow other users to put things in your backpack or steal from you. This
is, however, not recommended if you plan to take non-adventure files in
your backpack.
.PP
The directory \fI$HOME/.nadvwield/\fR is the implementation of the
collection of weapons you are wielding, armor, clothes and rings you are
wearing, and the wands and lightsource you are wielding.
.PP
Non-player characters have their home in \fI/var/tmp/nadvsh\fR (or
\&\fI/var/nadvsh\fR, if set up by the super-user). Their backpacks are found
in subdirectories below there, e.g. \fI/var/tmp/nadvsh/edrion/.nadvbackpack\fR.
.Sh "Location description files"
.IX Subsection "Location description files"
In any directory, a file \fI.nadvsh\fR may be created with a description of
the location. These files are parsed line-by-line. There are several line
types, each of which starts with a specific marker:
.Ip "\fBd:\fR" 4
.IX Item "d:"
Lines starting with \fBd:\fR are supposed to contain the long location
description. All \fBd:\fR descriptions are printed, with no newlines
between them.
.Ip "\fBf:\fR" 4
.IX Item "f:"
Optional \fBf:\fR lines contain location flags, separated by colons.
Flags in multiple \fBf:\fR lines are cumulative. The following flags are
supported (only those marked with a \fB+\fR have been implemented):
.Sp
.Vb 6
\&  + underwater        + dark
\&    surfacedeep       + darkbynight (e.g. outdoors)
\&    surfaceshallow    + obscured (e.g. misty or raining)
\&    nogravity           hot
\&  + noair               cold
\&    foulair           + radiation
.Ve
Restriction: flags that concern vision, like \fBdark\fR, \fBdarkbynight\fR and
\&\fBobscured\fR should be placed \fIbefore\fR the description of the location,
because the description is displayed while the file is parsed.
.Ip "\fBp:\fR" 4
.IX Item "p:"
Lines starting with \fBp:\fR contain the short description (to be used in
the prompt, and in the description given in response to the \fBlook into\fR
command). The short description should fit on one line and should not
end with a full stop. Multiple \fBp:\fR lines are concatenated with spaces
between them.
.Ip "\fBh:\fR" 4
.IX Item "h:"
If the short location description requires a different intro than
\&'You are in', you may specify a custom intro with the \fBh:\fR (head)
option. Multiple \fBh:\fR lines are concatenated with spaces between them.
.Ip "\fBe:\fR" 4
.IX Item "e:"
Optionally, \fBe:\fR lines may be included. These may be \fIeval()\fR-ed by
the shell.  This gives the writer an opportunity to interact with the
adventure variables and functions. A description file may contain multiple
\&\fBe:\fR lines, and these may be intermixed with e.g. \fBd:\fR lines.
.Sp
\&\fBe:\fR lines may be a security problem. Therefore, they are evaluated only
if the following criteria are met:
.RS 4
.Ip "\(bu" 4
Both the \fI.nadvsh\fR file and the current directory are owned by either
the current user or root, and are only writable by the owner.
.Ip "\(bu" 4
The script runs in \fBnosafe\fR mode (default: \fBsafe\fR), this can be changed
with the command \fBplay [no]safe\fR
.Ip "\(bu" 4
The current working directory matches the regular expression specified
by the \fBd_mode_safe_dirs\fR variable (default value: \f(CW\*(C`^$HOME($|/)\*(C'\fR )
.RE
.RS 4
.Sp
If the file and directory permissions and ownership are correct, but
the script is running in \fBsafe\fR mode or the directory is not included
in \fBd_mode_safe_dirs\fR, the string \fB(..)\fR will be appended to the location
description, to indicate that additional information was available.
.RE
.Ip "\fBr:\fR" 4
.IX Item "r:"
\&\fIRepetitive \fIeval()\fI\fR lines are not evaluated when the location is being
described, but instead before every prompt. The restrictions applicable
for \fBe:\fR lines also hold for \fBr:\fR lines. Multiple \fBr:\fR lines are
allowed, and will be executed in the order specified.
.PP
In the following examples, the text in the \fBe:\fR and \fBr:\fR lines is
supposed to occupy only one line.
.PP
\&\fBExample 1\fR
.PP
.Vb 5
\&    d:You are in a laboratory with many erlenmeyer flasks,
\&    d:round-bottom flasks and a destillation apparatus.
\&    p:a laboratory
\&    e:test $(($RANDOM % 2)) -eq 0 && d_wrap_noeol "A whisp of
\&        smoke rises from a nearby beaker."
.Ve
\&\fBExample 2\fR
.PP
.Vb 11
\&    d:You are on the bridge. There is a large holographic
\&    d:projection screen on one wall, depicting the asteroid
\&    d:belt outside.
\&    e:test -z "$d_captain_awake" &&
\&        d_wrap_noeol "The captain has fallen asleep near
\&        the communications panel and snores quietly."
\&    h:You are on
\&    p:the bridge
\&    f:nogravity
\&    r:if [ -z "$d_captain_awake" -a $(($RANDOM % 4)) -eq 0 ];
\&        then d_captain_awake=1; d_wrap "The captain wakes up."; fi
.Ve
.Sh "Object files"
.IX Subsection "Object files"
Object files are plain text files containing a description of the object.
They also must be \fImarked\fR as being an object, which means they should
contain at least one line starting with an \fIobject class marker\fR. These
markers consist of an alphabetic character, an alphanumeric character,
and a colon.
.PP
The description that follows the colon \s-1MUST\s0 immediately start with an
alphanumeric character. This restriction was imposed to minimize the
chance of finding a 'false positive' when checking a file (e.g. a tar file)
on its object status. For the same reason, and for performance reasons,
there is a maximum size to an object file, currently 2000 bytes.
.PP
In any description, the character sequence \f(CW\*(C`{pcurrency}\*(C'\fR may be used instead
of a specific currency name. This \fIcurrency marker\fR will be replaced by
the favorite currency of the player, when he/she examines it. Likewise,
\&\f(CW\*(C`{scurrency}\*(C'\fR will be replaced by the singular form of the currency.
.PP
Furthermore, objects that are charged (wands a.o.) may contain the character
sequence \f(CW\*(C`{chargecount}\*(C'\fR in the description, which will be replaced with
the chargecount (in English).
.PP
\&\fBExample 3\fR
.PP
.Vb 1
\&    fo:It is a crust of bread, and it looks quite wholesome.
.Ve
The crust is of class \fBfo\fR (food). The marker makes the object edible
for the 'eat' command.
.PP
\&\fBExample 4\fR
.PP
.Vb 2
\&    w1:The dagger is made of polished steel and
\&    has a dark leather hilt.
.Ve
The dagger is a class \fBw1\fR object, in this case, a weapon with attack
value +1. The example also shows a line which does not begin with a
marker.
.PP
\&\fBExample 5\fR
.PP
.Vb 2
\&    a1:This is a strong, but yet light metal helmet,
\&    c1:in the colors of the duke of Forstinea.
.Ve
This item is armor which has +1 defensive value (\fBa1\fR = class 'armor/+1')
and which should be worn as a helmet (\fBc0\fR = class 'clothing/helmet').
All armor objects should have an armor marker and a clothing marker. See
the clothing types in the table below.
.PP
\&\fBExample 6\fR
.PP
.Vb 1
\&    mo:12 {pcurrency}.
.Ve
This is a money object, representing 12 currency units. This example
demonstrates the use of \f(CW\*(C`{pcurrency}\*(C'\fR.
.PP
\&\fBExample (wrong)\fR
.PP
.Vb 2
\&    ri:An aquamarine ring radiating a soft bluish light.
\&    li:
.Ve
The problem with this object is that the class marker \fBli\fR (light source)
is not followed with an alphanumeric character. Therefore, it does not count
as a class marker. The solution is to break up the existing description
across the two lines.
.Sh "Object classes"
.IX Subsection "Object classes"
.Vb 22
\&  class description
\&  ----- -----------
\&  w1    melee weapon (+1 strength) (dagger, knife, club)
\&  w2    melee weapon (+2 strength) (quarterstaff, mace,
\&                                    short sword, spear)
\&  w3    melee weapon (+3 strength) (battle axe, scimitar)
\&  w4    melee weapon (+4 strength) (polearms, long sword)
\&  w5    melee weapon (+5 strength) (halberd, two-handed sword)
\&  --    --
\&  m0    firing weapon (rifle, arquebus, (laser) gun) (Not implemented)
\&  m1    missile weapon (o1 type missile) (sling)
\&  m2    missile weapon (o2 type missile) (light crossbow)
\&  m3    missile weapon (o3 type missile) (heavy crossbow)
\&  m4    missile weapon (o4 type missile) (short bow)
\&  m5    missile weapon (o5 type missile) (long bow)
\&  --    --
\&  o0    missile weapon (+1 strength) (dart, knife)
\&  o1    missile (+1 strength) (bullet)
\&  o2    missile (+2 strength) (light quarrel)
\&  o3    missile (+3 strength) (heavy quarrel)
\&  o4    missile (+4 strength) (flight arrow)
\&  o5    missile (+5 strength) (sheaf arrow)
.Ve
.Vb 8
\&  class description
\&  ----- -----------
\&  a1    armor (+1 defense) (helmet, gauntlets, small shield)
\&  a2    armor (+2 defense) (padded or studded leather, large shield)
\&  a3    armor (+3 defense) (scale mail, ring mail)
\&  a4    armor (+4 defense) (chain mail)
\&  a5    armor (+5 defense) (banded mail)
\&  a6    armor (+6 defense) (field plate armor)
.Ve
.Vb 12
\&  class description
\&  ----- -----------
\&  c1    clothing or armor worn on head (hat, cap, helmet)
\&  c2    clothing          worn on face (mask, glasses, goggles)
\&  c3    clothing          worn on upper body (jacket, vest, tunic)
\&  c4                armor worn over upper body (chain mail,
\&                                                bullet-proof vest)
\&  c5    clothing          worn over entire body (mantle, cape, robe)
\&  c6    clothing or armor worn on hands (gloves, gauntlets)
\&  c7                armor held in hands (shield)
\&  c8    clothing          worn on lower body (skirt, pants, trousers)
\&  c9    clothing          worn on feet (shoes, boots)
.Ve
.Vb 21
\&  class description
\&  ----- -----------
\&  v0    valuable object (     0-    10 gp)
\&  v1    valuable object (    10-    30 gp) (10 xp)
\&  v2    valuable object (    30-   100 gp) (20 xp)
\&  v3    valuable object (   100-   300 gp) (30 xp)
\&  v4    valuable object (   300-  1000 gp) (40 xp)
\&  v5    valuable object (  1000-  3000 gp) (50 xp)
\&  v6    valuable object (  3000- 10000 gp) (60 xp)
\&  v7    valuable object ( 10000- 30000 gp) (70 xp)
\&  v8    valuable object ( 30000-100000 gp) (80 xp)
\&  v9    valuable object (100000+       gp) (90 xp)
\&  --    --
\&  C#    charge count (# = nr. of charges, in range 0-9)
\&  D#    device       (# = type, in range 0-9)
\&  R#    rod          (# = type, in range 0-9)
\&  S#    staff        (# = type, in range 0-9)
\&  W#    wand         (# = type, in range 0-9)
\&  p#    potion       (# = type, in range 0-9)
\&  r#    magical ring (# = type, in range 0-9)
\&  s#    scroll       (# = type, in range 0-9)
.Ve
.Vb 15
\&  class description
\&  ----- -----------
\&  ba    backpack
\&  dr    drink
\&  fo    food
\&  li    light source
\&  mo    money
\&  mu    musical instrument
\&  ri    non-magical ring
\&  sc    scuba gear
\&  te    teleporter
\&  --    --
\&  ob    ordinary portable object
\&  nh    ordinary non-portable object (too heavy to carry)
\&  nf    ordinary non-portable object (fixed to wall, floor, ...)
.Ve
Other object classes are under development.
.Sh "Theme files"
.IX Subsection "Theme files"
Theme files may contain descriptions of locations, objects and non-player
characters. Theme files do not contain information about the whereabouts
of objects. For specifications of object and location descriptions,
see the descriptions under the respective headings in this man page.
Theme files are read in by the \fBtheme\fR command.
.PP
Records in a theme file may (and usually will) occupy multiple lines, and
start with a line indicating the record type. There is no record separator:
records start at a line beginning with the record marker. The following
types of records exist:
.Ip "\fBloc:\fR" 4
.IX Item "loc:"
A line beginning with \fBloc:\fR specifies (as an anchored regular expression
after the colon) a location (directory) which is described in the
following lines. The description may span multiple lines.
.Sp
Also, when a location description file (\fI.nadvsh\fR) is read in as a
theme file, an \fBloc:\fR line is implicitly created, and the file is read
in as if it were part of a theme file.
.Ip "\fBobj:\fR" 4
.IX Item "obj:"
This kind of record specifies an object. The \fBobj:\fR line should contain the
item name, and the lines following should contain the object description
(together with the object class markers). The description may span
multiple lines.
.Ip "\fBnpc:\fR" 4
.IX Item "npc:"
Specifies a non-player character. After the \fBnpc:\fR marker, the line must
contain space-separated fields with data about the character. The fields
may be quoted when they contain spaces.
.RS 4
.Ip "\(bu" 4
short name
.Ip "\(bu" 4
long name
.Ip "\(bu" 4
starting directory
.Ip "\(bu" 4
gender 
.Sp
Indicated by a single lowercase letter: \fBm\fRale, \fBf\fRemale, \fBn\fReuter,
\&\fBp\fRlural, or \fBs\fRingular (if the gender is unknown; not recommended). The
gender specification may also be used to indicate whether the \s-1NPC\s0
is considered a 'monster', by adding an \fBo\fR to the gender string,
e.g. \fBmo\fR for an orc or \fBfo\fR for a harpy. Monsters do not talk and
they don`t have backpacks.
.Ip "\(bu" 4
strength
.Sp
Normally in the range 1\-10, except for extreme monsters such as dragons a.o.
.Ip "\(bu" 4
charm
.Sp
Charm determines how inclined the \s-1NPC\s0 is to obey your requests. Normally
in the range 1\-10. (Not implemented)
.Ip "\(bu" 4
dexterity
.Sp
This determines a.o. how apt the \s-1NPC\s0 is at stealing. Normally in
the range 1\-10.
.RE
.RS 4
.Sp
Following the \fBnpc:\fR data line, there may be (multiple) lines containing
a description of the character.
.RE
.PP
\&\fBExample 7\fR
.PP
.Vb 18
\&    loc:/home/rene/newadventure/curve
\&    f:darkbynight
\&    d:The road curves to the east here.
\&    d:Cows graze calmly as you walk by.
\&    h:You have come to
\&    p:a curve in the road
\&    e:if [ $d_pc_strength -lt 5 ]; then d_wrap_noeol "The mere
\&        sight of the cows brings comfort to your heart.";
\&        let d_pc_strength+=1; fi
\&    obj:tungsten wand
\&    W3:This is a tungsten wand
\&    h3:with {chargecount} rubies
\&    inlaid in the shaft.
\&    npc:bobo 'Bobo Rockbiter' /home/rene/bobo m 6 8 10
\&    Bobo is quite tall, even for a Fallohide, and has red curly hair.
\&    npc:droid droid /usr/lib n 20 0 0
\&    The droid does not react to your presence at all, and
\&    continues performing system checks.
.Ve
.SH "BUGS and WARNINGS"
.IX Header "BUGS and WARNINGS"
Portability is probably not optimal. Not all Un*xes have been tested.
.PP
Two \f(CW\*(C`nadvsh\*(C'\fR shells run by the same user are \fInot\fR independent. In
particular, they share the backpack directories for the user and NPC`s.
.PP
Two \f(CW\*(C`nadvsh\*(C'\fR shells run by different users are not independent either:
they share the NPC`s backpack directories.
.PP
The script makes a number of \*(L"sanity assumptions\*(R", and therefore it does
not try to modify e.g. \fB\s-1PATH\s0\fR, \fB\s-1HOME\s0\fR, or the current \fBnounset\fR mode
(\fBset \-u\fR).
.PP
There are plenty opportunities for cheating. This, however, cannot be
avoided in an implementation such as this.
.PP
The default theme does not provide a consistent adventure (the objects
and location descriptions are from a different \*(L"setting\*(R" (medieval vs.
contemporary)). This will be fixed later.
.SH "PORTABILITY"
.IX Header "PORTABILITY"
\&\f(CW\*(C`nadvsh\*(C'\fR has been tested on:
.Ip "Linux 2.4.19\-pre6 / pdksh-5.2.14\-13" 4
.IX Item "Linux 2.4.19-pre6 / pdksh-5.2.14-13"
.PD 0
.Ip "Linux 2.4.19\-pre6 / bash-2.05a-13" 4
.IX Item "Linux 2.4.19-pre6 / bash-2.05a-13"
.Ip "Linux 2.4.19\-pre6 / zsh-4.0.2\-2" 4
.IX Item "Linux 2.4.19-pre6 / zsh-4.0.2-2"
.Ip "\s-1AIX\s0 4.3 / ksh" 4
.IX Item "AIX 4.3 / ksh"
.Ip "\s-1AIX\s0 4.3 / bash-2.01.0 (1)\-release" 4
.IX Item "AIX 4.3 / bash-2.01.0 (1)-release"
.Ip "\s-1HP-UX\s0 11.11 / ksh" 4
.IX Item "HP-UX 11.11 / ksh"
.Ip "\s-1HP-UX\s0 11.11 / bash-2.05b.0 (1)\-release" 4
.IX Item "HP-UX 11.11 / bash-2.05b.0 (1)-release"
.PD
Note: \f(CW\*(C`bash\-2.05.0 (2)\-release\*(C'\fR segfaults when sourcing the script.
This seems to be caused by large multiline string constants.
.Ip "SunOS 5.6 / ksh" 4
.IX Item "SunOS 5.6 / ksh"
.PD 0
.Ip "SunOS 5.8 / ksh" 4
.IX Item "SunOS 5.8 / ksh"
.PD
.SH "VERSION"
.IX Header "VERSION"
This manual pertains to \f(CW\*(C`nadvsh\*(C'\fR version 1.85.3 .
.SH "SEE ALSO"
.IX Header "SEE ALSO"
The manual pages for \fIksh\fR\|(1), \fIbash\fR\|(1) and \fIzsh\fR\|(1).
.SH "AUTHOR and INSPIRATION"
.IX Header "AUTHOR and INSPIRATION"
Written by Rene\*' Uittenbogaard (feedback, comments, bug reports
to: ruittenb@users.sourceforge.net).  Location descriptions were taken
from the mud-shell (see below), with kind permission from the author,
Dean Swift.
.PP
\&\f(CW\*(C`nadvsh\*(C'\fR was inspired by the following original 'adventure' shells:
.Ip "\fBadvshell\fR" 4
.IX Item "advshell"
in Bourne Shell script, by Doug Gwyn (February 1984)
http://www.ifarchive.org/if-archive/shells/
.Ip "\fBadvsh\fR" 4
.IX Item "advsh"
in C, by John Coker (April 1984)
http://www.ifarchive.org/if-archive/shells/
.Ip "\fBmud-shell\fR" 4
.IX Item "mud-shell"
in Perl, by Dean \*(L"Gandalf\*(R" Swift (March 2001)
http://www.xirium.com/tech/mud-shell/
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
This program is free software; you can redistribute it and/or modify it
under the terms described by the \s-1GNU\s0 General Public License version 2.
.PP
\&\f(CW\*(C`nadvsh\*(C'\fR is distributed without any warranty, even without the implied
warranties of merchantability or fitness for a particular purpose.
